import React from 'react';
import {render} from 'react-dom';

class App extends React.Component {
    constructor() {
        super();

        this.state = {
            data: 0
        };

        this.incrementNumber = this.incrementNumber.bind(this);
    };

    incrementNumber(incrementValue) {
        this.setState(
            (prevState) => ({
                data: prevState.data + incrementValue
            })
        )
    };

    render() {
        return (
            <div>
                <Button incrementValue={1} btnClick={this.incrementNumber} />
                <Button incrementValue={5} btnClick={this.incrementNumber} />
                <Button incrementValue={10} btnClick={this.incrementNumber} />
                <Result number={this.state.data} />
            </div>
        )
    }
}

const Result = (props) => {
    return (
        <div>
            <h3>{props.number}</h3>
        </div>
    );
};

class Button extends React.Component {

    handleClick() {
        this.props.btnClick(this.props.incrementValue);
    };

    render() {
        return (
            <button onClick={this.handleClick}>
                +{this.props.incrementValue}
            </button>
        )
    }
}

const Card = (props) => {
  return (
      <div style={{margin: '1em'}}>
          <img width="75" src={props.avatar_url} />
          <div style={{display: 'inline-block', marginLeft: 10}}>
              <div>
                  {props.name}
              </div>
              <div>
                  {props.company}
              </div>
          </div>
      </div>
  );
};

const CardList = (props) => {
    return (
        <div>
            {props.cards.map(card => <Card key={card.id} {...card} /> )}
        </div>
    )
};

class Form extends React.Component {
    constructor() {
        super();
        this.state = {
            userInputValue: ''
        };
        this.handleSubmit = this.handleSubmit.bind(this);
        this.handleOnChange = this.handleOnChange.bind(this);
    }

    handleSubmit(event) {
        event.preventDefault();
        console.log("Successful submiting", this.state.userInputValue);
        axios.get(`https://api.github.com/users/${this.state.userInputValue}`).then(resp => {
            console.log(resp);
            this.props.onSubmitResponse(resp.data);
            this.setState({userInputValue: ''});
        });
    }

    handleOnChange(event) {
        this.setState({
            userInputValue: event.target.value
        });
    }

    render() {
        return (
            <form onSubmit={this.handleSubmit}>
                <input type="text" placeholder="Enter github name" required
                       value={this.state.userInputValue} onChange={this.handleOnChange}/>
                <button type="submit">Add Cart</button>
            </form>
        );
    }
}

class App2 extends React.Component {
    constructor() {
        super();
        this.state = {
            cards: []
        };
        this.addNewCard = this.addNewCard.bind(this);
    }

    addNewCard(cardInfo) {
        this.setState(prevState => ({
            cards: prevState.cards.concat(cardInfo)
        }));
    }

    render() {
        return (
            <div>
                <Form onSubmitResponse={this.addNewCard}/>
                <CardList cards={this.state.cards} />
            </div>
        )
    }
}

render(<App2/>, document.getElementById('app'));

// setTimeout(() => {
//     ReactDOM.unmountComponentAtNode(document.getElementById('app'));}, 10000);
